<div class="widget-box">
  <div class="widget-header">
    <h4>Filtros de Reporte</h4>
    <div class="widget-toolbar"> <a data-action="collapse" href="#"> <i class="icon-chevron-up"></i> </a> <a data-action="close" href="#"> <i class="icon-remove"></i> </a> </div>
  </div>
  <div class="widget-body">
    <div class="widget-main no-padding">
      <form class="form-horizontal" role="form" id="principal" name="principal" action="?do=reportes.genera" method="post">
        <!-- <legend>Form</legend> -->
        <fieldset>
          <div class="form-group">
            <label for="idCompania" class="col-sm-3 control-label no-padding-right"> Compañia </label>
            <div class="col-sm-9">
              <select name="idCompania" class="chosen-select" id="idCompania" data-placeholder="Escoja una Compañia...">
				{companias}
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="idRamo" class="col-sm-3 control-label no-padding-right"> Ramo </label>
            <div class="col-sm-9">
              <select name="idRamo" class="chosen-select" id="idRamo" data-placeholder="Escoja un Ramo...">
                
						{ramos}
              
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="idRamo" class="col-sm-3 control-label no-padding-right"> Cliente </label>
            <div class="col-sm-9">
              <select name="idAsegurado" class="chosen-select" id="idAsegurado"  data-placeholder="Escoja un Cliente...">
				{clientes}
              </select>
            </div>
          </div>
          
        </fieldset>
        <input name="busqueda" type="hidden" id="busqueda" value="1" />
        <div class="form-actions center">
          <button class="btn btn-sm btn-success" id="enviarFormulario" type="button" onClick="enviaForm()"> Buscar <i class="icon-arrow-right icon-on-right bigger-110"></i> </button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="alert alert-danger" id="alerta">
  <button type="button" class="close" data-dismiss="alert"> <i class="icon-remove"></i> </button>
  <strong> <i class="icon-remove"></i> ¡Atencion! </strong> Debe seleccionar al menos un filtro. <br>
</div>
<div id="load">
<h3 class="center">Cargando Reporte...</h3>
<div class="progress progress-striped active" >
  <div class="progress-bar progress-bar-success" style="width: 100%;">
  </div>
</div></div>
<div id="reporte">
</div>
<script>
$('#load').hide();
$('#alerta').hide();
$(".chosen-select").chosen({
	no_results_text: "No se hay ningun registro con esos datos.",
	width: "100%"
}); 
$("#busAsegurado").click(function() {
	$.post("?do=clientes.serializar", {
	  'nombre' : $('#buscarAsegurado').val() },
	  function(data) {
		var sel = $("#asegurado");
		sel.empty();
		for (var i=0; i<data.length; i++) {
		  sel.append('<option value="' + data[i].idCliente + '">' + data[i].nombre + '</option>');
		}
	  }, "json");
	  $("#asegurado").prop( "disabled", false );
});
function enviaForm(){
	if($('#idAsegurado').val()!="" || $('#idCompania').val()!="" || $('#idRamo').val()!=""){
		$('#load').show();
		$('#alerta').hide();
		$( "#reporte" ).load( "?do=reportes.generaPantalla&vista=1&ase=" + $('#idAsegurado').val() + "&com=" +  $('#idCompania').val() + "&ram=" +  $('#idRamo').val(), function(){
			$('#load').hide();
		});
	}else{
		$('#alerta').show();
	}
}
</script>