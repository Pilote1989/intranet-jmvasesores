<div class="widget-box">
  <div class="widget-header">
    <h4>Filtros de Reporte</h4>
    <div class="widget-toolbar"> <a data-action="collapse" href="#"> <i class="icon-chevron-up"></i> </a> <a data-action="close" href="#"> <i class="icon-remove"></i> </a> </div>
  </div>
  <div class="widget-body">
    <div class="widget-main no-padding">
      <form class="form-horizontal" role="form" id="principal" name="principal" action="?do=reportes.genera" method="post">
        <!-- <legend>Form</legend> -->
        <fieldset>
          <div class="form-group">
            <label for="idCompania" class="col-sm-3 control-label no-padding-right"> Compa√±ia </label>
            <div class="col-sm-9">
              <select name="idCompania" class="col-sm-12" id="idCompania">
                
                
                
                
						{companias}
							
              
              
              
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="idRamo" class="col-sm-3 control-label no-padding-right"> Ramo </label>
            <div class="col-sm-9">
              <select name="idRamo" class="col-sm-12" id="idRamo">
                
						{ramos}
              
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="activas" class="col-sm-3 control-label no-padding-right"> Solo Activas </label>
            <div class="col-sm-9">
              <input name="activas" type="checkbox" value="1" id="activas" checked>
            </div>
          </div>
          <div class="form-group">
            <label for="buscarAsegurado" class="col-sm-3 control-label no-padding-right"> Asegurado </label>
            <div class="input-group col-sm-9">
              <div class="input-group">
                <input name="buscarAsegurado" id="buscarAsegurado" type="text" class="form-control">
                <span class="input-group-addon" id="busAsegurado"> <i class="icon-search bigger-110"></i> </span> </div>
            </div>
          </div>
          <div class="form-group">
            <label for="asegurado" class="col-sm-3 control-label no-padding-right"></label>
            <div class="col-sm-9">
              <select class="form-control" id="asegurado" name="asegurado[]" multiple="multiple" disabled="disabled">
                <option>Ingrese al menos 3 letras</option>
              </select>
            </div>
          </div>
        </fieldset>
        <input name="busqueda" type="hidden" id="busqueda" value="1" />
        <div class="form-actions center">
          <button class="btn btn-sm btn-success" id="enviarFormulario" type="button" onClick="enviaForm()"> Generar <i class="icon-arrow-right icon-on-right bigger-110"></i> </button>
        </div>
      </form>
    </div>
  </div>
</div>
<script>
$("#busAsegurado").click(function() {
	$.post("?do=clientes.serializar", {
	  'nombre' : $('#buscarAsegurado').val() },
	  function(data) {
		var sel = $("#asegurado");
		sel.empty();
		for (var i=0; i<data.length; i++) {
		  sel.append('<option value="' + data[i].idCliente + '">' + data[i].nombre + '</option>');
		}
	  }, "json");
	  $("#asegurado").prop( "disabled", false );
});
function enviaForm(){
	$.ajax({
		type: "POST",
		url: '?do=reportes.genera',
		data: $("#principal").serialize(),
		success: function() {
			window.location.replace("?do=reportes.historico");
		}
	});
}
</script>